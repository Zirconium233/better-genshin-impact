<ui:FluentWindow x:Class="BetterGenshinImpact.View.Windows.LlmConfigDialog"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:emoji="clr-namespace:Emoji.Wpf;assembly=Emoji.Wpf"
                 Width="700"
                 Height="800"
                 MinWidth="600"
                 MinHeight="600"
                 ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
                 ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                 ExtendsContentIntoTitleBar="True"
                 FontFamily="{DynamicResource TextThemeFontFamily}"
                 ResizeMode="CanResize"
                 WindowBackdropType="Mica"
                 WindowStartupLocation="CenterOwner"
                 mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <ui:TitleBar Title="LLM调度器配置" Grid.Row="0">
            <ui:TitleBar.Icon>
                <ui:ImageIcon Source="pack://application:,,,/Resources/Images/logo.png" />
            </ui:TitleBar.Icon>
        </ui:TitleBar>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">
                <!-- 标题和说明 -->
                <emoji:TextBlock Text="🤖 LLM调度器配置" 
                               FontSize="20" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10" />
                
                <emoji:TextBlock Text="配置LLM调度器的参数和用户指令" 
                               FontSize="14" 
                               Margin="0,0,0,20" 
                               Foreground="{DynamicResource TextFillColorSecondaryBrush}" />

                <!-- 用户指令区域 -->
                <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,20">
                    <StackPanel>
                        <emoji:TextBlock Text="💬 用户指令"
                                       FontWeight="Bold"
                                       FontSize="16"
                                       Margin="0,0,0,10" />

                        <emoji:TextBlock Text="prompt："
                                       FontSize="14"
                                       Margin="0,0,0,8" />
                        
                        <TextBox Name="UserPromptTextBox"
                                 Height="80"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"
                                 FontSize="13"
                                 Padding="10"
                                 Text="帮我战斗，优先使用元素技能和元素爆发" />
                        
                        <emoji:TextBlock Text="💡 示例：帮我战斗、探索这个区域、收集材料、完成任务等" 
                                       FontSize="12" 
                                       Margin="0,8,0,0" 
                                       FontStyle="Italic"
                                       Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}" />
                    </StackPanel>
                </Border>

                <!-- 记忆和Prompt配置 -->
                <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,20">
                    <StackPanel>
                        <emoji:TextBlock Text="🧠 记忆和Prompt配置" 
                                       FontWeight="Bold" 
                                       FontSize="16" 
                                       Margin="0,0,0,15" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- 记忆模式 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="记忆模式:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ComboBox Name="MemoryModeComboBox" Grid.Row="0" Grid.Column="1" Margin="0,0,0,8">
                                <ComboBoxItem Content="SingleFrame" IsSelected="False" />
                                <ComboBoxItem Content="NearDense" IsSelected="True" />
                                <ComboBoxItem Content="Agent" IsSelected="False" />
                            </ComboBox>

                            <!-- Prompt模式 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Prompt模式:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ComboBox Name="PromptModeComboBox" Grid.Row="1" Grid.Column="1" Margin="0,0,0,8">
                                <ComboBoxItem Content="General" IsSelected="True" />
                                <ComboBoxItem Content="Combat" IsSelected="False" />
                                <ComboBoxItem Content="Exploration" IsSelected="False" />
                            </ComboBox>

                            <!-- 启用思考过程 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="启用思考过程:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <CheckBox Name="EnableThoughtCheckBox" Grid.Row="2" Grid.Column="1" Margin="0,0,0,8" />

                            <!-- 输出长度控制 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="输出长度控制:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ComboBox Name="OutputLengthComboBox" Grid.Row="3" Grid.Column="1" Margin="0,0,0,8">
                                <ComboBoxItem Content="Variable" IsSelected="True" />
                                <ComboBoxItem Content="Fixed3" IsSelected="False" />
                                <ComboBoxItem Content="Fixed5" IsSelected="False" />
                            </ComboBox>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- 触发器配置 -->
                <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,20">
                    <StackPanel>
                        <emoji:TextBlock Text="⚡ 触发器配置" 
                                       FontWeight="Bold" 
                                       FontSize="16" 
                                       Margin="0,0,0,15" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- 调用触发器 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="调用触发器:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ComboBox Name="CallTriggerComboBox" Grid.Row="0" Grid.Column="1" Margin="0,0,0,8">
                                <ComboBoxItem Content="ActionGroupCompleted" IsSelected="True" />
                                <ComboBoxItem Content="QueueRemaining" IsSelected="False" />
                                <ComboBoxItem Content="FixedInterval" IsSelected="False" />
                            </ComboBox>

                            <!-- 结束触发器 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="结束触发器:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ComboBox Name="EndTriggerComboBox" Grid.Row="1" Grid.Column="1" Margin="0,0,0,8">
                                <ComboBoxItem Content="LlmExit" IsSelected="True" />
                                <ComboBoxItem Content="EnvException" IsSelected="False" />
                                <ComboBoxItem Content="LlmExit,EnvException" IsSelected="False" />
                            </ComboBox>

                            <!-- 固定间隔（秒） -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="固定间隔（秒）:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ui:NumberBox Name="FixedIntervalNumberBox" Grid.Row="2" Grid.Column="1" Margin="0,0,0,8" 
                                         Value="5" Minimum="1" Maximum="60" />
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- API参数配置 -->
                <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,20">
                    <StackPanel>
                        <emoji:TextBlock Text="🔧 API参数配置" 
                                       FontWeight="Bold" 
                                       FontSize="16" 
                                       Margin="0,0,0,15" />
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- 最大Token数 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="最大Token数:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ui:NumberBox Name="MaxTokensNumberBox" Grid.Row="0" Grid.Column="1" Margin="0,0,0,8" 
                                         Value="1000" Minimum="100" Maximum="4000" />

                            <!-- 温度参数 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="温度参数:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ui:NumberBox Name="TemperatureNumberBox" Grid.Row="1" Grid.Column="1" Margin="0,0,0,8" 
                                         Value="0.7" Minimum="0" Maximum="2" SmallChange="0.1" />

                            <!-- 近期帧数 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="近期帧数:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ui:NumberBox Name="RecentFrameCountNumberBox" Grid.Row="2" Grid.Column="1" Margin="0,0,0,8" 
                                         Value="3" Minimum="1" Maximum="10" />

                            <!-- 远期间隔 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="远期间隔:" VerticalAlignment="Center" Margin="0,0,10,8" />
                            <ui:NumberBox Name="DistantFrameIntervalNumberBox" Grid.Row="3" Grid.Column="1" Margin="0,0,0,8"
                                         Value="2" Minimum="1" Maximum="10" />
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- 按钮区域 -->
                <StackPanel Orientation="Horizontal" 
                            HorizontalAlignment="Right"
                            Margin="0,20,0,0">
                    <ui:Button Name="BtnCancel"
                               Content="取消"
                               Margin="0,0,10,0"
                               Padding="20,8"
                               Click="BtnCancelClick" />
                    
                    <ui:Button Name="BtnOk"
                               Content="确定"
                               Appearance="Primary"
                               Padding="20,8"
                               IsDefault="True"
                               Click="BtnOkClick" />
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</ui:FluentWindow>
